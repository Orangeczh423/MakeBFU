{"version":3,"sources":["assets\\scripts\\Game.js"],"names":["Fruit","cc","Class","name","properties","id","iconSF","SpriteFrame","JuiceItem","particle","circle","slash","Component","fruits","type","titleText","Node","score","ground","endNodeBG","endNode","juices","fruitPrefab","Prefab","juicePrefab","boomAudio","AudioClip","knockAudio","waterAudio","onLoad","lastWidth","node","width","count","getComponent","Label","y","isCreating","fruitCount","isEnd","topBound","buttomBound","initPhysics","initBound","on","EventType","TOUCH_END","onTouchEnd","TOUCH_MOVE","onTouchMove","view","resizeWithBrowserSize","initOneFruit","meta","i","console","log","instance","director","getPhysicsManager","enabled","gravity","v2","collisionManager","getCollisionManager","x","height","body","addComponent","RigidBody","RigidBodyType","Static","_addBound","collider","PhysicsBoxCollider","offset","size","parent","currentFruit","createFruitOnPos","e","cur","removeFromParent","fruit","pos","getLocation","tween","by","position","easing","t","call","startFruitPhysics","scheduleOnce","nextId","getNextFruitId","start","Math","floor","random","createOneFruit","num","instantiate","config","init","PhysicsCircleCollider","radius","addChild","scale","onSameFruitContact","bind","onCheckBound","Dynamic","physicsCircleCollider","apply","to","setPosition","self","other","off","createFruitJuice","newFruit","string","String","parseInt","last_x","setTimeout","end_msg","n","audioEngine","play","juice","showJuice"],"mappings":"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","sourceRoot":"/","sourcesContent":["const Fruit = cc.Class({\n    name: 'FruitItem',\n    properties: {\n        id: 0,\n        iconSF: cc.SpriteFrame\n    }\n});\n\nconst JuiceItem = cc.Class({\n    name: 'JuiceItem',\n    properties: {\n        particle: cc.SpriteFrame,\n        circle: cc.SpriteFrame,\n        slash: cc.SpriteFrame,\n    }\n});\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        fruits: {\n            default: [],\n            type: Fruit\n        },\n\n        titleText: {\n            default: null,\n            type: cc.Node\n        },\n\n        score: {\n            default: null,\n            type: cc.Node\n        },\n\n        ground: {\n            default: null,\n            type: cc.Node\n        },\n\n        endNodeBG: {\n            default: null,\n            type: cc.Node\n        },\n\n        endNode: {\n            default: null,\n            type: cc.Node\n        },\n\n        juices: {\n            default: [],\n            type: JuiceItem\n        },\n\n        // 动态生成 找到批量处理预置元素的方案\n        fruitPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        juicePrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        // todo 可以实现一个audioManager\n        boomAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n        knockAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n        waterAudio: {\n            default: null,\n            type: cc.AudioClip\n        }\n    },\n\n    onLoad() {\n        // 记录当前屏幕大小\n        this.lastWidth = this.node.width;\n\n        // 记录北京林业数量\n        this.count = 0;\n\n        this.score = this.score.getComponent(cc.Label);\n\n        // 设置地面位置\n        this.ground.y = 15;\n\n        this.isCreating = false;\n        this.fruitCount = 0;\n        this.isEnd = false;\n\n        // 距离上边界的位置\n        this.topBound = 15;\n        // 地面位置\n        this.buttomBound = 15;\n\n        this.initPhysics();\n        this.initBound();\n\n        // 监听点击事件 todo 是否能够注册全局事件\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n\n        cc.view.resizeWithBrowserSize(false);\n\n        this.initOneFruit();\n\n        const meta = [\n            \"开发者:原项目开发(暂未找到),JinYu\",\n            \"本项目仓库地址：https://github.com/Kingfish404/Make-WUT\",\n            \"原项目：武汉理工大学\",\n            \"北京林业大学信息学院数字媒体技术 ByCZH\",\n            \"翻制date:2022-01-25\",\n        ]\n\n        for (let i of meta) {\n            console.log(i);\n        }\n    },\n\n    // 开启物理引擎和碰撞检测\n    initPhysics() {\n        // 物理引擎\n        const instance = cc.director.getPhysicsManager();\n        instance.enabled = true;\n        // instance.debugDrawFlags = 4\n        instance.gravity = cc.v2(0, -960);\n\n        // 碰撞检测\n        const collisionManager = cc.director.getCollisionManager();\n        collisionManager.enabled = true\n    },\n\n    // 设置边界和UI位置\n    initBound() {\n        // 设置标题位置\n        this.titleText.x = 15;\n\n        // 设置分数位置\n        this.score.node.x = this.node.width - 15;\n\n        // 设置四周的碰撞区域\n        let width = this.node.width;\n        let height = this.node.height;\n\n        let node = new cc.Node();\n\n        let body = node.addComponent(cc.RigidBody);\n        body.type = cc.RigidBodyType.Static;\n\n        const _addBound = (node, x, y, width, height) => {\n            let collider = node.addComponent(cc.PhysicsBoxCollider);\n            collider.offset.x = x;\n            collider.offset.y = y;\n            collider.size.width = width;\n            collider.size.height = height;\n        }\n\n        _addBound(node, 0, -height / 2 + this.buttomBound, width, 1);\n        _addBound(node, 0, height / 2, width, 1);\n        _addBound(node, -width / 2, 0, 1, height);\n        _addBound(node, width / 2, 0, 1, height);\n\n        node.parent = this.node;\n    },\n\n    initOneFruit(id = 1) {\n        this.fruitCount++\n        this.currentFruit = this.createFruitOnPos(0, 400, id)\n    },\n\n    // 监听屏幕点击完毕\n    onTouchEnd(e) {\n        if (this.isCreating) {\n            return;\n        }\n        if (this.isEnd) {\n            if (this.currentFruit) {\n                let cur = this.currentFruit;\n                this.currentFruit.removeFromParent(false);\n            }\n            return;\n        }\n        if (this.lastWidth != this.node.width) {\n            // 屏幕大小改变了，重新设置边界\n            this.initBound();\n        }\n        this.isCreating = true;\n\n        const fruit = this.currentFruit;\n        const width = this.node.width;\n        const pos = e.getLocation();\n        let x = pos.x - width / 2;\n        fruit.x = x;\n\n        cc.tween(fruit)\n            .by(0, { position: cc.v2(0, 0) }, { easing: t => 100000 * t * t })\n            .call(() => {\n                // 开启物理效果\n                this.startFruitPhysics(fruit)\n\n                // 0.75s后重新生成一个\n                this.scheduleOnce(() => {\n                    const nextId = this.getNextFruitId();\n\n                    this.initOneFruit(nextId)\n                    this.isCreating = false\n                }, 0.75)\n            }).start();\n    },\n\n    // 监听屏幕移动\n    onTouchMove(e) {\n        if (this.isCreating) {\n            return;\n        }\n\n        const width = this.node.width;\n        const pos = e.getLocation();\n        let x;\n        if (pos.x <= this.currentFruit.width / 2 || pos.x >= width - this.currentFruit.width / 2) {\n            return;\n        } else {\n            x = pos.x - width / 2;\n        }\n        this.currentFruit.x = x;\n    },\n\n    // 获取下一个水果的id\n    getNextFruitId() {\n        if (this.fruitCount < 3) {\n            return 1\n        } else if (this.fruitCount === 3) {\n            return 2\n        } else {\n            // 随机返回前5个\n            return Math.floor(Math.random() * 5) + 1\n        }\n    },\n    // 创建一个水果\n    createOneFruit(num) {\n        let fruit = cc.instantiate(this.fruitPrefab);\n        const config = this.fruits[num - 1];\n\n        fruit.getComponent('Fruit').init({\n            id: config.id,\n            iconSF: config.iconSF\n        });\n\n        fruit.getComponent(cc.RigidBody).type = cc.RigidBodyType.Static;\n        fruit.getComponent(cc.PhysicsCircleCollider).radius = 0;\n\n        this.node.addChild(fruit);\n        fruit.scale = 0.6;\n\n        // 有Fruit组件传入\n        fruit.on('sameContact', this.onSameFruitContact.bind(this));\n        fruit.on('checkBound', this.onCheckBound.bind(this));\n\n        return fruit;\n    },\n\n    startFruitPhysics(fruit) {\n        fruit.getComponent(cc.RigidBody).type = cc.RigidBodyType.Dynamic;\n        const physicsCircleCollider = fruit.getComponent(cc.PhysicsCircleCollider);\n        physicsCircleCollider.radius = fruit.height / 2;\n        physicsCircleCollider.apply();\n    },\n\n    // 在指定位置生成水果\n    createFruitOnPos(x, y, type = 1) {\n        const fruit = this.createOneFruit(type)\n        cc.tween(fruit)\n            .to(0.25, { scale: 0.8 })\n            .start();\n        fruit.setPosition(cc.v2(x, y));\n        return fruit\n    },\n    // 两个水果碰撞\n    onSameFruitContact({ self, other }) {\n        other.node.off('sameContact'); // 两个node都会触发，todo 看看有没有其他方法只展示一次的\n\n        const id = other.getComponent('Fruit').id;\n        // todo 可以使用对象池回收\n        self.node.removeFromParent(false);\n        other.node.removeFromParent(false);\n\n        const { x, y } = other.node;\n\n        this.createFruitJuice(id, cc.v2({ x, y }), other.node.width);\n\n        let nextId = id + 1;\n        if (nextId <= 9) {\n            if (nextId == 8) {\n                // 统计数量\n                this.count++;\n            }\n            if (nextId == 9) {\n                nextId = 1;\n            }\n            const newFruit = this.createFruitOnPos(x, y, nextId);\n\n            // 分数累加\n            this.score.string = String(parseInt(this.score.string) + nextId * 10);\n\n            this.startFruitPhysics(newFruit);\n\n            // 展示动画 todo 动画效果需要调整\n            newFruit.scale = 0\n            cc.tween(newFruit).to(.5, {\n                scale: 0.8\n            }, {\n                easing: \"backOut\"\n            }).start()\n        } else {\n            // todo 合成两个西瓜\n            console.log(' todo 合成两个最大的 还没有实现哦~ ');\n        }\n    },\n\n    // 检测当前的两个水果是否超出边界了\n    onCheckBound({ self, other }) {\n        if (this.lastWidth == this.node.width && self.node.y + self.node.width / 2 > this.node.y - this.topBound) {\n            // TODO fix bug in here\n            const last_x = self.node.x;\n            setTimeout(() => {\n                if (this.lastWidth == this.node.width && last_x == self.node.x && self.node.y + self.node.width / 2 > this.node.y - this.topBound) {\n                    console.log(\"超出范围啦\");\n                    // 设置显示结束\n                    this.endNode.x = this.node.width / 2;\n                    this.endNode.y = this.node.height / 2;\n                    this.endNodeBG.x = this.node.width / 2;\n                    this.endNodeBG.y = this.node.height / 2;\n                    let end_msg = this.endNode.getComponent(cc.Label);\n                    if (this.count == 0) {\n\n                    } else {\n                        end_msg.string = '恭喜你合成了\\n\\n' + this.count + '个北林绿团';\n                    }\n                    this.isEnd = true;\n                }\n            }, 1500);\n        }\n    },\n\n    // 合并时的动画效果\n    createFruitJuice(id, pos, n) {\n        // 播放合并的声音\n        cc.audioEngine.play(this.boomAudio, false, 1);\n        cc.audioEngine.play(this.waterAudio, false, 1);\n\n        // 展示动画\n        let juice = cc.instantiate(this.juicePrefab);\n        this.node.addChild(juice);\n\n        const config = this.juices[id - 1];\n        const instance = juice.getComponent('Juice');\n        instance.init(config);\n        instance.showJuice(pos, n);\n    }\n});"]}